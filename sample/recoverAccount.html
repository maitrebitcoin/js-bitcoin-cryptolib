<!DOCTYPE html>
<html>
<head>
    <title>  Sample - recorver account </title>    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <p>Enter 12, 15, 18, 21 or 24 words :</p>
    <br><textarea id="word" class="secretInput" ></textarea> 
    <button onclick="GenerateRandomWords(12)"> genererate 12 at random </button>
    <button onclick="GenerateRandomWords(15)"> genererate 15 at random </button>
    <br><br>

    <button onclick="recoverAccount()"> Recover public adresses </button>

    <!----------------------------- final account  -------------------------------->
    <p id="public" hidden=true>
        <span id="publicAdress"></span><br><br>
        <button onclick="onCopy('publicAdress')">copy</button>    
    </p>
    <p id="error" hidden=true></p>    

    <!----------------------------- javscript code -------------------------------->
    
<script src='../src/js-bitcoin-lib.js'></script> 
<script src='sample-utils.js'></script> 
<script>

function GenerateRandomWords(nbWord) {

    // generate a random new wallet
    var myWallet     = new BitcoinWallet(  WalletType.SEGWIT_NATIVE  );  
    myWallet.initFromRandom(nbWord)
    // get the mnemonic phrase
    var phrase       = myWallet.phrase  
    document.getElementById("word").value  = phrase
}

async function recoverAccount() {

    document.getElementById("public").hidden   = true   
    document.getElementById("error").hidden    = true   

    //get phrase
    var phrase  = document.getElementById("word").value 
    // calc seed
    try {
        var seed         = seedFromPhrase(phrase)
    }
    catch (error) {
        showError(error)
        return;
    }

    // create a new wallet 
    var myWallet   = new BitcoinWallet(  WalletType.SEGWIT_NATIVE  );
    // use the seed a the base for all adresses calculations
    myWallet.initFromSeed(seed)
    // get the 1st public adress. 
    var pubAdress0   =  myWallet.getPublicAddress(0)
   
    var prettyPhrase = "<table align='center'><tr>"
    var tabWord = phrase.split(' ')
    for (var i=0;i<tabWord.length;i++) {
        var rc = (i>0 && i%2==0)  
        if (rc) prettyPhrase += "</tr><tr>"          
        prettyPhrase += "<td id='numword'>&nbsp" + (i+1)+ "&nbsp</td>"   
        prettyPhrase += "<td>" + tabWord[i] + "</td>"
        prettyPhrase += "<td>&nbsp&nbsp</td>"
 
    }
    prettyPhrase+='</tr></table>'

    // show result
    document.getElementById("publicAdress").innerHTML = pubAdress0 ; 
    document.getElementById("public").hidden    = false   

}
    
</script>
   
</body>
</html>